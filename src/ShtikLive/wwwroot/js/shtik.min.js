var Shtik;(function(n){var t;(function(n){class t{constructor(){this._autoSave=()=>{this._autosaveTimeout&&clearTimeout(this._autosaveTimeout),this._autosaveTimeout=setTimeout(()=>{this.save().then(n=>{n||this._autoSave()})},2e3)};this.load=()=>{fetch(this.notesUrl,{method:"GET",credentials:"same-origin"}).then(n=>n.text()).then(n=>{const t=JSON.parse(n);this._textarea.value=t.text})};this.save=()=>{if(!this._setSaving(!0))return Promise.resolve(!1);const i=this._textarea.value,t=JSON.stringify({text:i}),n=new Headers;return n.append("Content-Type","application/json"),n.append("Content-Length",t.length.toString()),fetch(this.notesUrl,{method:"PUT",credentials:"same-origin",body:t,headers:n}).then(()=>this._setSaving(!1),!0).catch(n=>console.log(n),this._setSaving(!1),!1)};this._setSaving=n=>this._saving&&n?!1:(this._saving=this._button.disabled=n,n?this._button.classList.add("disabled"):this._button.classList.remove("disabled"),this._saving);this._form=document.getElementById("notes");this._textarea=this._form.querySelector("textarea");this._button=this._form.querySelector("button");window.addEventListener("popstate",this.load);this._textarea.addEventListener("keyup",this._autoSave);this._textarea.addEventListener("paste",this._autoSave)}get notesUrl(){const n=window.location.pathname.split("/"),t=n.pop(),i=n.pop(),r=n.pop();return`/api/notes/${r}/${i}/${t}`}}n.NotesForm=t})(t=n.Notes||(n.Notes={}))})(Shtik||(Shtik={})),function(n){var t;(function(){function u(n){return fetch(n,{method:"GET"}).then(n=>n.text())}function t(){const n=window.location.href+"/partial";u(n).then(n=>{const t=JSON.parse(n);document.querySelector("div.slide").innerHTML=t.slide.html})}function f(n){history.pushState(null,null,n);t()}var r=n.Notes.NotesForm,i;document.addEventListener("DOMContentLoaded",()=>{const n=window.location.protocol==="https:"?"wss:":"ws:",u=window.location.pathname.substr(5).replace(/\/[0-9]+$/,""),e=`${n}//${window.location.host}${u}`,o=new WebSocket(e);o.onmessage=n=>{const t=JSON.parse(n.data);t.slide&&f(window.location.pathname.replace(/\/[0-9]+$/,`${t.slide}`))};window.addEventListener("popstate",t);i=new r;i.load()});console.log("Bobbins")})(t=n.AutoNav||(n.AutoNav={}))}(Shtik||(Shtik={}));